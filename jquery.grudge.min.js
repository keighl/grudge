/*
 * Grudge - Modals... meh.

 * Copyright (c) 2012 Kyle Truscott
 *
 * http://keighl.github.com/grudge
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
!function(e){"use strict";var n={init:function(c){return e(this).each(function(){var s=e(this),t={speed:250,classes:{backdrop:"grudge-backdrop",inner:"grudge-inner",close:"grudge-close"},callbacks:{content:function(){},pre_launch:function(){},post_launch:function(){},pre_dismiss:function(){},post_dismiss:function(){}},objects:{backdrop:null,inner:null,close:null}};c&&e.extend(!0,t,c),s.bind("click.grudge",n.launch),s.data("grudge",t)})},launch:function(){var c=e(this),s=c.data("grudge");return s?(s.callbacks.pre_launch.call(c),s.objects.backdrop=e("<div />",{"class":s.classes.backdrop}).appendTo("body").bind("click.grudge",function(t){e(t.target).attr("class")===s.classes.backdrop&&n.dismiss.call(c)}),s.objects.inner=e("<div />",{"class":s.classes.inner}).append(s.callbacks.content.call(c)).appendTo("body"),s.objects.close=e("<a />",{"class":s.classes.close,href:"#"}).bind("click.grudge",function(){return n.dismiss.call(c),!1}).appendTo(s.objects.inner),c.data("grudge",s),s.objects.backdrop.fadeIn(s.speed,function(){}),s.objects.inner.fadeIn(s.speed,function(){e(document).bind("keyup.grudge",function(e){27===e.keyCode&&n.dismiss.call(c)}),s.callbacks.post_launch.call(c)}),!1):!1},dismiss:function(){var n=e(this),c=n.data("grudge");return c?c.objects.backdrop?(c.callbacks.pre_dismiss.call(n),c.objects.inner.fadeOut(c.speed,function(){e(this).remove()}),c.objects.backdrop.fadeOut(c.speed,function(){e(this).remove(),c.objects={backdrop:null,inner:null,close:null},n.data("grudge",c),c.callbacks.post_dismiss.call(n)}),!1):!1:!1},destroy:function(){return e(this).each(function(){var n=e(this),c=n.data("grudge");return c?(n.data("grudge",null),n.unbind(".grudge"),void 0):!1})}};e.fn.grudge=function(c){return n[c]?n[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?(e.error("Method "+c+" does not exist on jQuery.grudge!"),void 0):n.init.apply(this,arguments)}}(jQuery);